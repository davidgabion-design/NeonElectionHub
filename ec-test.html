<!DOCTYPE html>
<html>
<head>
    <title>EC Access Test</title>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
        
        const firebaseConfig = {
            apiKey: "AIzaSyBNuIYfcsi2NWkK1Ua4Tnycaf_qM3oix1s",
            authDomain: "neon-voting-app.firebaseapp.com",
            projectId: "neon-voting-app",
            storageBucket: "neon-voting-app.firebasestorage.app",
            messagingSenderId: "406871836482",
            appId: "1:406871836482:web:b25063cd3829cd3dc6aadb",
            measurementId: "G-VGW2Z3FR8M"
        };
        
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        
        async function testECAccess() {
            console.log("Testing EC access...");
            
            try {
                // Test 1: Check if organization exists
                const orgId = "demo-university-2024";
                const orgRef = doc(db, "organizations", orgId);
                const orgSnap = await getDoc(orgRef);
                
                if (orgSnap.exists()) {
                    const org = orgSnap.data();
                    console.log("✅ Organization found:", org.name);
                    console.log("   EC Password:", org.ecPassword || "NOT SET");
                    console.log("   Voter count:", org.voterCount || 0);
                    
                    // Test 2: Try to read voters
                    try {
                        // Just check if we can access
                        console.log("✅ Firestore access working");
                    } catch (error) {
                        console.log("❌ Cannot access subcollections:", error.message);
                    }
                } else {
                    console.log("❌ Organization not found!");
                    console.log("   Create it in Super Admin panel first");
                }
                
            } catch (error) {
                console.error("❌ Test failed:", error);
                console.error("Error code:", error.code);
                console.error("Error message:", error.message);
            }
        }
        
        // Run test
        testECAccess();
    </script>
</head>
<body>
    <h1>EC Access Test</h1>
    <p>Open browser console (F12) to see results</p>
    <button onclick="testECAccess()">Run Test Again</button>
</body>
</html>
